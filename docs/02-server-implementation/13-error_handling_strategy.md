# 에러 처리 전략

이 장에서는
서버 프로그램에서 발생하는 에러를
**어떤 기준으로 처리하고 어떤 형태로 응답할지**를 정한다.

에러 처리는
"예외가 나면 잡는다" 수준이 아니라,
서버 품질을 결정하는 **설계 요소**다.

---

## 강의 목표

* 서버에서 발생하는 에러 유형을 구분할 수 있다
* 왜 에러 처리를 한 곳으로 모아야 하는지 설명할 수 있다
* 일관된 에러 응답 형식을 설계할 수 있다
* Controller에서 try-catch를 남발하면 안 되는 이유를 이해한다

---

## 1. 서버에서 에러는 자연스럽게 발생한다

서버는 항상 정상 입력만 받지 않는다.

대표적인 상황:

* 필수 값 누락
* 잘못된 타입/형식
* 존재하지 않는 자원 요청
* DB 작업 실패

중요한 관점:

> 에러는 "없애는 것"이 아니라
> "통제하는 것"이다.

---

## 2. 에러를 처리하지 않으면 생기는 문제

에러 처리를 설계하지 않으면
다음 문제가 발생한다.

* 화면/클라이언트에 의미 없는 에러가 노출된다
* API마다 응답 형식이 제각각이 된다
* 디버깅이 어려워진다

---

## 3. 가장 흔한 실수: Controller try-catch 남발

초보자가 가장 많이 하는 실수는
Controller마다 try-catch를 넣는 것이다.

```text
/users 컨트롤러에서 try-catch
/posts 컨트롤러에서 try-catch
/comments 컨트롤러에서 try-catch
```

이 방식의 문제:

* 중복 코드 폭증
* 에러 응답 형식이 흔들림
* 실수로 예외를 삼켜서(로그도 없이) 장애 원인 추적 불가

> Controller는 요청/응답만 담당해야 한다.

---

## 4. 에러 처리는 "한 곳"에서 한다

서버 품질을 높이려면
에러 처리를 한 곳으로 모아야 한다.

목표:

* 모든 예외를 동일한 규칙으로 응답
* 로그와 응답을 분리
* 장애 원인 추적 가능

---

## 5. 에러 응답 형식(표준) 설계

에러 응답도 API 응답이다.
따라서 형식이 필요하다.

예시(권장):

```json
{
  "success": false,
  "message": "사용자를 찾을 수 없습니다",
  "code": "USER_NOT_FOUND"
}
```

형식 설계 포인트:

* `success`: 성공/실패
* `message`: 사용자에게 보여줄 메시지
* `code`: 클라이언트가 분기 처리할 수 있는 코드

> 실습에서는 단순하게 시작하고
> 운영 단계에서 확장한다.

---

## 6. Spring의 공통 예외 처리 개념

Spring에서는 보통
공통 예외 처리 지점을 만든다.

개념 흐름:

```text
Controller/Service/Repository에서 예외 발생
  ↓
공통 처리 지점이 예외를 잡음
  ↓
정해진 형식으로 응답 변환
```

이렇게 하면
Controller가 깔끔해지고
에러 응답이 일관된다.

---

## 7. 지금 단계에서 하지 않는 것

이 장에서는 다음을 다루지 않는다.

* 예외 클래스 상세 설계
* 특정 프레임워크 애노테이션 문법 상세
* 에러 코드 표준화 전부

이 장의 목적은
"에러 처리의 방향"을 잡는 것이다.

---

## 이 장의 핵심 정리

* 에러는 통제 대상이다
* Controller에 try-catch를 남발하지 않는다
* 에러 처리는 공통 처리 지점으로 모은다
* 에러 응답도 일관된 형식을 가져야 한다

---

## 다음 단계

→ [**로깅 전략**](14-logging_strategy.md)