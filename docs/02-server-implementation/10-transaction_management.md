# 트랜잭션 관리

이 장에서는
서버 프로그램에서 **여러 데이터 변경 작업을 하나의 작업 단위로 묶는 방법**을 이해한다.

앞 장에서 커넥션 풀을 통해
DB 연결이 어떻게 관리되는지 살펴봤다면,
이제는 **그 연결 위에서 데이터의 일관성을 어떻게 보장하는지**를 다룬다.

---

## 강의 목표

* 트랜잭션의 개념을 설명할 수 있다
* 여러 SQL 작업을 하나로 묶어야 하는 이유를 이해한다
* 성공/실패에 따른 커밋(commit)과 롤백(rollback)의 의미를 안다
* Spring에서 트랜잭션을 어떻게 다루는지 개념적으로 이해한다

---

## 1. 트랜잭션이란 무엇인가

트랜잭션(transaction)은
**여러 작업을 하나의 논리적 작업 단위로 묶은 것**이다.

특징:

* 모두 성공하거나
* 하나라도 실패하면 모두 취소된다

> "전부 아니면 전무(all or nothing)"

---

## 2. 트랜잭션이 필요한 상황

예를 들어 다음과 같은 작업을 생각해보자.

1. 주문 정보 저장
2. 결제 정보 저장

만약 1번은 성공했지만
2번이 실패한다면 문제가 생긴다.

* 주문은 존재하지만
* 결제는 없는 상태

이런 상황을 막기 위해
트랜잭션이 필요하다.

---

## 3. 커밋과 롤백

트랜잭션에는 두 가지 중요한 동작이 있다.

* **Commit**: 모든 작업을 확정
* **Rollback**: 작업을 모두 취소

```text
성공 → Commit
실패 → Rollback
```

---

## 4. 트랜잭션과 DB 커넥션의 관계

트랜잭션은
**하나의 DB 커넥션 단위로 관리된다.**

```text
하나의 커넥션
  ↳ 여러 SQL
  ↳ 하나의 트랜잭션
```

그래서 커넥션 풀과 트랜잭션은
항상 함께 이해해야 한다.

---

## 5. 트랜잭션을 사용하지 않으면 생기는 문제

트랜잭션이 없으면:

* 중간 실패 시 데이터 불일치
* 예외 처리 난이도 증가
* 복구가 어려워짐

> 서버에서 데이터 무결성은
> 매우 중요한 책임이다.

---

## 6. Spring에서의 트랜잭션 관리 (개념)

Spring에서는
트랜잭션 관리를 **프레임워크가 대신 처리**해준다.

일반적인 흐름:

```text
Service 시작
  → 트랜잭션 시작
  → Repository 작업들
  → 정상 종료 시 Commit
  → 예외 발생 시 Rollback
```

> 실제 코드 적용은
> 다음 단계에서 진행한다.

---

## 7. 지금 단계에서 하지 않는 것

이 장에서는 다음을 다루지 않는다.

* 트랜잭션 전파 옵션
* 격리 수준(isolation)
* 세부 설정

이 내용들은
서버 구조 이해 이후에 다룬다.

---

## 이 장의 핵심 정리

* 트랜잭션은 작업의 일관성을 보장한다
* 여러 SQL은 하나의 트랜잭션으로 묶여야 한다
* 커밋과 롤백은 성공/실패의 기준이다
* Spring은 트랜잭션을 자동으로 관리한다

---

## 다음 단계

→ [**요청 / 응답 흐름 정리**](11-request_response_flow.md)

