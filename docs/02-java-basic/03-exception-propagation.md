# ì˜ˆì™¸ ì „íŒŒ í•µì‹¬ ì •ë¦¬

ì´ ì¥ì—ì„œëŠ” ìë°”ì—ì„œ ì˜ˆì™¸ê°€ **ì–´ë–»ê²Œ ì „ë‹¬ë˜ê³ , ì–¸ì œ ì²˜ë¦¬ë˜ë©°, ì™œ íŠ¹ì • ìœ„ì¹˜ì—ì„œë§Œ catch í•´ì•¼ í•˜ëŠ”ì§€**ë¥¼ ê°œë…ì ìœ¼ë¡œ ì •ë¦¬í•œë‹¤.

ì´ ë‚´ìš©ì€ ì´í›„ **Global Exception ì²˜ë¦¬ êµ¬ì¡°**ë¡œ í™•ì¥í•˜ê¸° ìœ„í•œ í•„ìˆ˜ ì „ì œë‹¤.

---

## 0. í˜¸ì¶œ ìŠ¤íƒ(Call Stack)ì´ë€?

* **ë©”ì„œë“œê°€ í˜¸ì¶œë˜ëŠ” ìˆœì„œë¥¼ ìœ„ì—ì„œ ì•„ë˜ë¡œ ìŒ“ì•„ë‘ëŠ” ì‹¤í–‰ ê¸°ë¡ ê³µê°„**ì´ë‹¤
* ë©”ì„œë“œê°€ í˜¸ì¶œë˜ë©´ ìŠ¤íƒì— ìŒ“ì´ê³ 
* ë©”ì„œë“œê°€ ì¢…ë£Œë˜ë©´ ìŠ¤íƒì—ì„œ ì œê±°ëœë‹¤

ì¦‰,

> ì§€ê¸ˆ ì–´ë–¤ ë©”ì„œë“œê°€ ì‹¤í–‰ ì¤‘ì´ê³ ,
> ê·¸ ë©”ì„œë“œë¥¼ ëˆ„ê°€ í˜¸ì¶œí–ˆëŠ”ì§€ë¥¼ ê¸°ì–µí•˜ëŠ” êµ¬ì¡°ë‹¤

### í˜¸ì¶œ ìŠ¤íƒ ì˜ˆì‹œ

```text
main()
 â””â”€ controller()
       â””â”€ service()
             â””â”€ repository()
```

* í˜„ì¬ ì‹¤í–‰ ì¤‘: `repository()`
* ì´ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œ ìˆœì„œê°€ ê·¸ëŒ€ë¡œ **í˜¸ì¶œ ìŠ¤íƒ**ì´ë‹¤

---

## 1. ì˜ˆì™¸ ì „íŒŒë€?

* ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ **í˜„ì¬ ë©”ì„œë“œì—ì„œ ì¦‰ì‹œ ì¤‘ë‹¨**ëœë‹¤

* ì¤‘ë‹¨ì´ ë˜ë©´ **í˜¸ì¶œ ìŠ¤íƒ(Call Stack)ì„ ë”°ë¼ ê±°ìŠ¬ëŸ¬ ì˜¬ë¼ê°„ë‹¤**

* ë°œìƒí•œ ì˜ˆì™¸ëŠ” ì¡íë•Œê¹Œì§€ ì „ë‹¬ëœë‹¤.

### ì˜ˆì™¸ê°€ â€œì¡íŒë‹¤â€ì˜ ì •í™•í•œ ì˜ë¯¸

> **ë°œìƒí•œ ì˜ˆì™¸ íƒ€ì…ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” `catch`ê°€ í˜¸ì¶œ ìŠ¤íƒ ì–´ë”˜ê°€ì— ì¡´ì¬í•˜ë©´**
  â†’ ê·¸ ì˜ˆì™¸ëŠ” ì¡íŒ ê²ƒì´ë‹¤

---

## 3. ì˜ˆì™¸ê°€ ì¡íˆëŠ” ì¡°ê±´

ì˜ˆì™¸ê°€ ì¡íˆê¸° ìœ„í•´ì„œëŠ” **ëª¨ë“  ì¡°ê±´ì„ ë§Œì¡±**í•´ì•¼ í•œë‹¤.

* `catch`ê°€ ì¡´ì¬í•´ì•¼ í•œë‹¤

* `catch`ì˜ íƒ€ì…ì´ **ë°œìƒí•œ ì˜ˆì™¸ íƒ€ì…ê³¼ ê°™ê±°ë‚˜ ë¶€ëª¨ íƒ€ì…**ì´ì–´ì•¼ í•œë‹¤

* ì˜ˆì™¸ê°€ ì¡í˜€ì„œ í•´ë‹¹ `catch`ê°€ ì‹¤í–‰ë˜ëŠ” ìˆœê°„ **ì˜ˆì™¸ ì „íŒŒëŠ” ì¤‘ë‹¨ëœë‹¤**

```java
try {
    throw new IllegalArgumentException();
} catch (IllegalArgumentException e) {
    // ì—¬ê¸°ì„œ ì²˜ë¦¬ â†’ ì „íŒŒ ì¤‘ë‹¨
}
```

---

## 4. ì˜ˆì™¸ê°€ ì¡íˆì§€ ì•ŠëŠ” ê²½ìš°

### 1) catch ìì²´ê°€ ì—†ëŠ” ê²½ìš°

```java
throw new RuntimeException();
```

* í˜¸ì¶œ ìŠ¤íƒ ëê¹Œì§€ ì „íŒŒ
* JVMì´ ì²˜ë¦¬ â†’ í”„ë¡œê·¸ë¨ ì¢…ë£Œ

---

### 2) catchëŠ” ìˆìœ¼ë‚˜ íƒ€ì…ì´ ë§ì§€ ì•ŠëŠ” ê²½ìš°

```java
try {
    throw new RuntimeException();
} catch (IOException e) {
}
```

* íƒ€ì… ë¶ˆì¼ì¹˜
* í•´ë‹¹ `catch`ëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
* ì˜ˆì™¸ëŠ” ê³„ì† ì „íŒŒë¨

---

## 5. catch ì‹¤í–‰ì˜ ì˜ë¯¸

* `catch` ë¸”ë¡ì´ ì‹¤í–‰ë˜ëŠ” ìˆœê°„
  â†’ í•´ë‹¹ ì˜ˆì™¸ ê°ì²´ëŠ” **ì²˜ë¦¬ëœ ê²ƒìœ¼ë¡œ ê°„ì£¼**ëœë‹¤
* ì²˜ë¦¬ëœ ì˜ˆì™¸ëŠ” **ë” ì´ìƒ í˜¸ì¶œ ìŠ¤íƒì„ ë”°ë¼ ì „íŒŒë˜ì§€ ì•ŠëŠ”ë‹¤**

ë‹¨, ë‹¤ìŒ ê²½ìš°ëŠ” ì˜ˆì™¸ë‹¤.

```java
catch (RuntimeException e) {
    throw e; // ë‹¤ì‹œ ë˜ì§€ë©´ ìƒˆë¡œìš´ ì „íŒŒ ì‹œì‘
}
```

---

## 6. catchëŠ” ë‹¨ í•˜ë‚˜ë§Œ ì‹¤í–‰ëœë‹¤

* í˜¸ì¶œ ìŠ¤íƒ ì „ì²´ì—ì„œ
  **ê°€ì¥ ë¨¼ì € ë§Œë‚˜ëŠ” ì²˜ë¦¬ ê°€ëŠ¥í•œ catch í•˜ë‚˜ë§Œ ì‹¤í–‰**ëœë‹¤
* ì—¬ëŸ¬ catchê°€ ë™ì‹œì— ì‹¤í–‰ë˜ëŠ” ì¼ì€ ì—†ë‹¤

---

## ìµœì¢… ìš”ì•½

* ì˜ˆì™¸ëŠ” **í˜¸ì¶œ ìŠ¤íƒì„ ë”°ë¼ ìœ„ë¡œ ì „íŒŒëœë‹¤**
* ì˜ˆì™¸ê°€ ì¡íŒë‹¤ëŠ” ê²ƒì€
  â†’ **ì²˜ë¦¬ ê°€ëŠ¥í•œ catchê°€ í˜¸ì¶œ ìŠ¤íƒì— ì¡´ì¬í•œë‹¤ëŠ” ëœ»**ì´ë‹¤
* `catch`ê°€ ì‹¤í–‰ë˜ë©´ **ì˜ˆì™¸ ì „íŒŒëŠ” ì¦‰ì‹œ ì¤‘ë‹¨**ëœë‹¤
* ëê¹Œì§€ ì¡íˆì§€ ì•Šìœ¼ë©´ **JVMì´ ì²˜ë¦¬í•˜ê³  í”„ë¡œê·¸ë¨ì€ ì¢…ë£Œëœë‹¤**

---

# ì‹¤ìŠµ: Error.javaë¡œ ì˜ˆì™¸ ì „íŒŒ íë¦„ í™•ì¸

ì´ ì‹¤ìŠµì—ì„œëŠ” **í˜¸ì¶œ ìŠ¤íƒì„ ë”°ë¼ ì˜ˆì™¸ê°€ ì–´ë–»ê²Œ ì „ë‹¬ë˜ê³ , ì–´ë””ì„œ ë©ˆì¶”ëŠ”ì§€**ë¥¼ ì§ì ‘ í™•ì¸í•œë‹¤.
Global Exception ì²˜ë¦¬ êµ¬ì¡°ë¡œ ê°€ê¸° ì „ **ê°œë…ì„ ì½”ë“œë¡œ ê³ ì •**í•˜ëŠ” ë‹¨ê³„ë‹¤.

---

## 1. Error.java íŒŒì¼ ìƒì„±

`src/Error.java`

```java
public class Error {

    public static void main(String[] args) {
        System.out.println("[main] start");

        try {
            controller(args);
            System.out.println("[main] ì •ìƒ ì¢…ë£Œ");
        } catch (Exception e) {
            System.out.println("[main] catch ì‹¤í–‰: " + e.getClass().getSimpleName());
        }

        System.out.println("[main] end");
    }

    static void controller(String[] args) {
        System.out.println("[controller] í˜¸ì¶œë¨");
        service(args);
        System.out.println("[controller] ì¢…ë£Œ");
    }

    static void service(String[] args) {
        System.out.println("[service] í˜¸ì¶œë¨");
        repository(args);
        System.out.println("[service] ì¢…ë£Œ");
    }

    static void repository(String[] args) {
        System.out.println("[repository] í˜¸ì¶œë¨");

        if (args.length == 0) {
            throw new IllegalArgumentException("ì¸ì ì—†ìŒ");
        }

        System.out.println("[repository] ì •ìƒ ì²˜ë¦¬");
    }
}
```

---

## 2. ì‹¤í–‰ ì‹¤ìŠµ â‘  : ì¸ì ì—†ì´ ì‹¤í–‰

```bash
java Error
```

í™•ì¸í•  ê²ƒ:

* `repository`ì—ì„œ ì˜ˆì™¸ ë°œìƒ
* `repository` ì´í›„ ì½”ë“œëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
* `service ì¢…ë£Œ`, `controller ì¢…ë£Œ`ëŠ” ì¶œë ¥ë˜ì§€ ì•ŠìŒ
* ì˜ˆì™¸ëŠ” `main`ì˜ catchì—ì„œ ì¡í˜

ğŸ‘‰ **ì˜ˆì™¸ê°€ í˜¸ì¶œ ìŠ¤íƒì„ ë”°ë¼ ìœ„ë¡œ ì „ë‹¬ë¨**ì„ í™•ì¸í•œë‹¤.

---

## 3. ì‹¤í–‰ ì‹¤ìŠµ â‘¡ : ì¸ì ì „ë‹¬ í›„ ì‹¤í–‰

```bash
java Error hello
```

í™•ì¸í•  ê²ƒ:

* ëª¨ë“  ë©”ì„œë“œê°€ ì •ìƒ ì¢…ë£Œë¨
* catch ë¸”ë¡ì€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ

---

## 4. catch ìœ„ì¹˜ ë³€ê²½ ì‹¤ìŠµ

`try-catch` ë¥¼ `controller`ì— ì¶”ê°€í•´ë³¸ë‹¤.

```java
static void controller(String[] args) {
    try {
        System.out.println("[controller] í˜¸ì¶œë¨");
        service(args);
        System.out.println("[controller] ì¢…ë£Œ");
    } catch (Exception e) {
        System.out.println("[controller] catch ì‹¤í–‰");
    }
}
```

í™•ì¸í•  ê²ƒ:

* ì˜ˆì™¸ëŠ” `controller`ì—ì„œ ì¡í˜
* `main`ì˜ catchëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠìŒ

ğŸ‘‰ **ê°€ì¥ ë¨¼ì € ë§Œë‚˜ëŠ” catch í•˜ë‚˜ë§Œ ì‹¤í–‰ë¨**ì„ í™•ì¸í•œë‹¤.

---

## 5. ë‹¤ì‹œ ë˜ì§€ê¸° ì‹¤ìŠµ (rethrow)

`controller`ì˜ catchì—ì„œ ì˜ˆì™¸ë¥¼ ë‹¤ì‹œ ë˜ì§„ë‹¤.

```java
catch (Exception e) {
    System.out.println("[controller] catch ì‹¤í–‰ í›„ ë‹¤ì‹œ ë˜ì§");
    throw e;
}
```

í™•ì¸í•  ê²ƒ:

* `controller`ì˜ catch ì‹¤í–‰ë¨
* ì´í›„ `main`ì˜ catchë„ ì‹¤í–‰ë¨

ğŸ‘‰ **catchì—ì„œ ë‹¤ì‹œ ë˜ì§€ë©´ ìƒˆë¡œìš´ ì˜ˆì™¸ ì „íŒŒê°€ ì‹œì‘ëœë‹¤**.

---

## 6. NullPointerException íƒ€ì… ì—ëŸ¬ ì¼ë•Œë§Œ ë˜ì§€ê¸°


```java
catch (Exception e) {
    
    if (e instanceof NullPointerException){
      throw e;
    }else{
      System.out.println(e);
    }

}
```

## í•œ ë¬¸ì¥ ì •ë¦¬

> ì˜ˆì™¸ëŠ” ë°œìƒí•œ ë©”ì„œë“œì—ì„œ ë©ˆì¶”ê³ ,
> ì²˜ë¦¬ ê°€ëŠ¥í•œ catchë¥¼ ë§Œë‚  ë•Œê¹Œì§€
> í˜¸ì¶œ ìŠ¤íƒì„ ë”°ë¼ ìœ„ë¡œ ì „ë‹¬ëœë‹¤.

---

## Spring ì—°ê²° ë¬¸ì¥

* `repository` / `service` â†’ ì˜ˆì™¸ ë°œìƒ í›„ throw
* `controller` â†’ ì„±ê³µì¼ë•Œ return ë§Œ í•¨
* `Global Exception Handler` â†’ ì—ëŸ¬ë¥¼ ë°›ì•„ì„œ ì¼ê´„ ì²˜ë¦¬

ì´ êµ¬ì¡°ê°€ Spring ì˜ˆì™¸ ì²˜ë¦¬ì˜ ê·¸ëŒ€ë¡œì¸ í˜•íƒœë‹¤.

---

## ë‹¤ìŒ ë‹¨ê³„

[**Controllerì—ì„œ returnìœ¼ë¡œ ê°’ ì „ë‹¬í•˜ê¸°**](04-controller-parameter-and-return.md)
