# 객체 생성과 의존성 연결

> **요청을 받는 쪽(Controller) / 비즈니스(Service) / 저장소(Repository)** 를 분리하고,
> **객체는 누가 만들고, 왜 생성자로 넘기는지**를 코드로 이해한다.

---

## 1. 프로젝트 구조 (순수 자바)

```text
java-practice/src/
              ├─ App.java
              ├─ UserController.java
              ├─ UserService.java
              └─ UserRepository.java
```
### 자바 프로젝트 생성
1. 탐색기 우클릭 [ **New Java Project** ]
2. [ **No build tools** ] - [ **.../projects/koreanit-server/** ]
3. [ Input a Java project name ] - **java-practice** 입력

---

## 2. Repository 만들기 (저장 담당)

```java
public class UserRepository {

    public void save(String username) {
        System.out.println("[Repository] 사용자 저장: " + username);
    }
}
```

* 데이터 저장 역할만 담당
* 비즈니스 판단 없음

---

## 3. Service 만들기 (비즈니스 담당)

```java
public class UserService {

    private final UserRepository userRepository;

    public UserService(UserRepository userRepository) {
        this.userRepository = userRepository;
    }

    public void join(String username) {
        System.out.println("[Service] 회원가입 처리");
        userRepository.save(username);
    }
}
```

* Service는 Repository가 필수
* 생성자로 의존성을 강제
* Service 내부에서 `new UserRepository()` 하지 않는다

---

## 4. Controller 만들기 (요청 담당)

```java
public class UserController {

    private final UserService userService;

    public UserController(UserService userService) {
        this.userService = userService;
    }

    // 사용자의 요청을 받는 메서드
    public void join(String username) {
        System.out.println("[Controller] 회원가입 요청");
        userService.join(username);
        System.out.println("[Controller] 회원가입 요청 처리 완료");
    }
}
```

* Controller는 입력/요청 담당
* 비즈니스 판단 ❌
* 저장 처리 ❌
* Service에게 위임만 한다

---

## 5. Main(App)에서 객체 연결하기 (중앙 조립소)

```java
public class App {

    public static void main(String[] args) {

        UserRepository repository = new UserRepository();
        UserService service = new UserService(repository);
        UserController controller = new UserController(service);

        controller.join("admin");
    }
}
```

* 객체 생성(`new`)과 연결은 **오직 main에서만**

---

## 6. 실행 흐름 정리

1. `main` 시작

2. `UserRepository` 생성
3. `UserService` 생성 (Repository 주입)
4. `UserController` 생성 (Service 주입)
5. `controller.join()` 호출
6. Controller → Service → Repository

예상 출력:

```text
[Controller] 회원가입 요청
[Service] 회원가입 처리
[Repository] 사용자 저장: admin
```

---

## 7. 역할 요약

| 계층         | 역할                 | new 사용 |
| ---------- | ------------------ | ------ |
| Controller | 요청 받기 / 입력 처리 / 위임 | ❌      |
| Service    | 비즈니스 로직            | ❌      |
| Repository | 데이터 저장             | ❌      |
| Main(App)  | 객체 생성 + 의존성 연결     | ✅      |

---

## 8. 스프링과 연결 (1:1 대응)

| 지금(순수 자바)                     | 스프링에서                      |
| ----------------------------- | -------------------------- |
| `new UserController(service)` | `@RestController` + 생성자 주입 |
| `new UserService(repo)`       | `@Service` + 생성자 주입        |
| `new UserRepository()`        | `@Repository`              |
| `App.main()`                  | Spring Container           |

> **스프링은 Main에서 하던 일을 대신해준다**

---

## 다음 단계

→ [**Service 흐름과 비즈니스 판단**](02.md)
